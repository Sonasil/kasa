module.exports=[65066,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(30485);var e=a.i(31052);a.i(69387);var f=a.i(60574),g=a.i(18740),h=a.i(40695),i=a.i(3130),j=a.i(7706),k=a.i(50463),l=a.i(65602),m=a.i(77687),n=a.i(5094),o=a.i(81010),p=a.i(56738),q=a.i(46842),r=a.i(70106);let s=(0,r.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var t=a.i(92e3),u=a.i(50522);let v=(0,r.default)("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);var w=a.i(60246),x=a.i(90166),y=a.i(24669);let z=(0,r.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var A=a.i(60625),B=a.i(1907);function C(){let a=(0,d.useRouter)(),{formatMoney:r,t:C}=(0,A.useSettings)(),{photoURL:D}=(0,B.useUserProfile)(),{toast:E}=(0,m.useToast)(),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(0),[Z,$]=(0,c.useState)(0),[_,aa]=(0,c.useState)(0),[ab,ac]=(0,c.useState)(0),ad=(0,c.useMemo)(()=>{let a=(N||P||"?").trim().split(/\s+/).filter(Boolean);return 0===a.length?"?":1===a.length?a[0].slice(0,2).toUpperCase():(a[0][0]+a[1][0]).toUpperCase()},[N,P]),ae=async()=>{K(!1);try{await (0,e.signOut)(g.auth)}catch(a){console.warn("Sign out failed:",a)}finally{a.push("/login")}};return((0,c.useEffect)(()=>{let b=null,c=null,d=[],h=()=>{d.forEach(a=>{try{a()}catch{}}),d=[]},i=(0,e.onAuthStateChanged)(g.auth,async e=>{if(I(null),b){try{b()}catch{}b=null}if(h(),!e){M(null),G(!1),a.push("/login");return}M(e.uid),Q(e.email||""),O(e.displayName||""),S(e.photoURL||"");let i=e.metadata?.creationTime?new Date(e.metadata.creationTime):null;if(i?U(new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(i)):U(""),c)try{c()}catch{}let j=(0,f.doc)(g.db,"users",e.uid);c=(0,f.onSnapshot)(j,a=>{let b=a.data();if("string"==typeof b?.displayName&&O(b.displayName),"string"==typeof b?.email&&Q(b.email),"string"==typeof b?.photoURL&&S(b.photoURL),b?.createdAt?.toDate){let a=b.createdAt.toDate();U(new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(a))}},a=>{console.warn("Failed to read user profile doc:",a)});let k=(0,f.query)((0,f.collection)(g.db,"groups"),(0,f.where)("memberIds","array-contains",e.uid)),l={},m=()=>{$(Object.values(l).reduce((a,b)=>a+b,0))};b=(0,f.onSnapshot)(k,a=>{h();let b=a.docs.map(a=>({id:a.id,...a.data()}));Y(b.length);let c=0,i=0;for(let a of b){let b=a?.totalAmount;"number"==typeof b&&(c+=b);let d=a?.balances,f=d&&"object"==typeof d?d[e.uid]:void 0;"number"==typeof f&&(i+=f)}for(let a of(aa(c),ac(i),b)){let b=(0,f.query)((0,f.collection)(g.db,"groups",a.id,"feed"),(0,f.orderBy)("createdAt","desc"),(0,f.limit)(50)),c=(0,f.onSnapshot)(b,b=>{let c=0;b.forEach(a=>{let b=a.data();b?.type==="expense"&&(c+=1)}),l[a.id]=c,m()},()=>{l[a.id]=0,m()});d.push(c)}m(),G(!1)},a=>{console.error("Failed to load groups:",a),I(C("failedToLoad")),Y(0),$(0),aa(0),ac(0),G(!1)})});return()=>{try{i()}catch{}if(b)try{b()}catch{}if(c)try{c()}catch{}h()}},[a]),F)?(0,b.jsx)("div",{className:"min-h-screen bg-background pb-20",children:(0,b.jsxs)("div",{className:"mx-auto max-w-4xl p-3 sm:p-6",children:[(0,b.jsx)(k.Skeleton,{className:"h-8 w-32 mb-4 sm:mb-6"}),(0,b.jsx)(i.Card,{className:"p-4 sm:p-6 mb-3 sm:mb-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,b.jsx)(k.Skeleton,{className:"h-16 w-16 sm:h-20 sm:w-20 rounded-full"}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(k.Skeleton,{className:"h-5 w-32 sm:w-40"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-40 sm:w-48"})]})]})}),(0,b.jsx)(i.Card,{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:(0,b.jsx)(k.Skeleton,{className:"h-12 w-full"})})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-background pb-20",children:[(0,b.jsxs)("div",{className:"mx-auto max-w-4xl",children:[H&&(0,b.jsxs)(l.Alert,{variant:"destructive",className:"m-3 sm:m-4",children:[(0,b.jsx)(t.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(l.AlertDescription,{children:H})]}),(0,b.jsx)("div",{className:"relative bg-gradient-to-br from-primary/10 via-primary/5 to-background border-b",children:(0,b.jsx)("div",{className:"p-4 sm:p-6 pb-16 sm:pb-20",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,b.jsxs)(j.Avatar,{className:"h-20 w-20 sm:h-24 sm:w-24 border-4 border-background shadow-lg",children:[D?(0,b.jsx)(j.AvatarImage,{src:D,alt:N||P||"Avatar"}):null,(0,b.jsx)(j.AvatarFallback,{className:"text-2xl sm:text-3xl font-bold bg-primary text-primary-foreground",children:ad})]}),(0,b.jsx)("h1",{className:"mt-3 text-xl sm:text-2xl font-bold",children:N||C("noName")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:P||""}),(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-1 text-xs text-muted-foreground",children:[(0,b.jsx)(z,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[C("memberSince")," ",T||"â€”"]})]})]})})}),(0,b.jsxs)("div",{className:"px-3 sm:px-4 -mt-12 sm:-mt-14",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,b.jsxs)(i.Card,{className:"p-3 sm:p-4 bg-card/95 backdrop-blur",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:"rounded-full bg-blue-100 dark:bg-blue-950 p-1.5",children:(0,b.jsx)(w.Users,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-blue-600 dark:text-blue-400"})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:C("groupsTitle")})]}),(0,b.jsx)("p",{className:"text-xl sm:text-2xl font-bold",children:X})]}),(0,b.jsxs)(i.Card,{className:"p-3 sm:p-4 bg-card/95 backdrop-blur",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:"rounded-full bg-green-100 dark:bg-green-950 p-1.5",children:(0,b.jsx)(x.DollarSign,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-green-600 dark:text-green-400"})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:C("totalExpenses")})]}),(0,b.jsx)("p",{className:"text-xl sm:text-2xl font-bold",children:Z})]}),(0,b.jsxs)(i.Card,{className:"p-3 sm:p-4 bg-card/95 backdrop-blur",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:"rounded-full bg-purple-100 dark:bg-purple-950 p-1.5",children:(0,b.jsx)(y.TrendingUp,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-purple-600 dark:text-purple-400"})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:C("totalSpent")})]}),(0,b.jsx)("p",{className:"text-base sm:text-lg font-bold",children:r(_)})]}),(0,b.jsxs)(i.Card,{className:"p-3 sm:p-4 bg-card/95 backdrop-blur",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:`rounded-full p-1.5 ${ab>=0?"bg-green-100 dark:bg-green-950":"bg-red-100 dark:bg-red-950"}`,children:(0,b.jsx)(x.DollarSign,{className:`h-3.5 w-3.5 sm:h-4 sm:w-4 ${ab>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:C("balance")})]}),(0,b.jsx)("p",{className:`text-base sm:text-lg font-bold ${ab>=0?"text-green-600":"text-red-600"}`,children:r(ab)})]})]}),(0,b.jsxs)(i.Card,{className:"p-3 sm:p-4 mb-3 sm:mb-4",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground mb-3 px-1",children:C("settings").toUpperCase()}),(0,b.jsxs)("button",{onClick:()=>a.push("/settings"),className:"w-full flex items-center justify-between p-3 sm:p-4 rounded-lg border hover:bg-accent hover:border-accent-foreground/10 transition-all text-left focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"rounded-full bg-primary/10 p-2 sm:p-2.5 shrink-0",children:(0,b.jsx)(v,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm sm:text-base font-semibold",children:C("appSettings")}),(0,b.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:C("preferencesPermissions")})]})]}),(0,b.jsx)(u.ChevronRight,{className:"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground shrink-0"})]})]}),(0,b.jsxs)(h.Button,{variant:"destructive",className:"w-full h-11 sm:h-10 mb-4",onClick:()=>K(!0),children:[(0,b.jsx)(s,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}),C("signOut")]}),(0,b.jsxs)("div",{className:"text-center pb-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:C("ksExpenseApp")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground/70 mt-0.5",children:"Version 1.0.0"})]})]})]}),(0,b.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-card border-t border-border z-50",children:(0,b.jsx)("div",{className:"mx-auto max-w-4xl px-6 py-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-around",children:[(0,b.jsx)("button",{onClick:()=>a.push("/groups"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors hover:bg-accent","aria-label":C("navGroups"),children:(0,b.jsx)(p.Wallet,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)("button",{onClick:()=>a.push("/"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors hover:bg-accent","aria-label":C("navHome"),children:(0,b.jsx)(o.Home,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)("button",{onClick:()=>a.push("/profile"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors","aria-label":C("navProfile"),children:(0,b.jsx)(q.User,{className:"h-6 w-6 text-green-600"})})]})})}),(0,b.jsx)(n.AlertDialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(n.AlertDialogContent,{children:[(0,b.jsxs)(n.AlertDialogHeader,{children:[(0,b.jsx)(n.AlertDialogTitle,{children:C("signOutConfirmTitle")}),(0,b.jsx)(n.AlertDialogDescription,{children:C("signOutConfirmDesc")})]}),(0,b.jsxs)(n.AlertDialogFooter,{children:[(0,b.jsx)(n.AlertDialogCancel,{children:C("cancel")}),(0,b.jsx)(n.AlertDialogAction,{onClick:ae,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:C("signOut")})]})]})})]})}a.s(["default",()=>C],65066)}];

//# sourceMappingURL=app_profile_page_tsx_d7e3fb30._.js.map