module.exports=[44162,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(3130),g=a.i(54161),h=a.i(50463),i=a.i(65733),j=a.i(5522),k=a.i(17171),l=a.i(21958),m=a.i(77687),n=a.i(18740);a.i(69387);var o=a.i(60574);async function p(a){let b=n.auth.currentUser;if(!b)throw Error("Kullanıcı oturumu bulunamadı. Lütfen tekrar giriş yapın.");let c=a.trim();if(!c)throw Error("Grup adı boş olamaz.");return{groupId:(await (0,o.addDoc)((0,o.collection)(n.db,"groups"),{name:c,createdBy:b.uid,memberIds:[b.uid],isActive:!0,createdAt:(0,o.serverTimestamp)()})).id}}var q=a.i(15618),r=a.i(60246),s=a.i(90166),t=a.i(24669),u=a.i(53277),v=a.i(79257),w=a.i(81010),x=a.i(56738),y=a.i(46842),z=a.i(70106);let A=(0,z.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var B=a.i(79360);let C=(0,z.default)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),D=(0,z.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var E=a.i(60625),F=a.i(76504);function G(){let a=(0,d.useRouter)(),{toast:z}=(0,m.useToast)(),{formatMoney:G,t:H}=(0,E.useSettings)(),[I,J]=(0,c.useState)(!0),[K,L]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a,b=n.auth.onAuthStateChanged(b=>{if(!b){a&&(a(),a=void 0),L([]),J(!1);return}J(!0);let c=(0,o.query)((0,o.collection)(n.db,"groups"),(0,o.where)("memberIds","array-contains",b.uid));a&&(a(),a=void 0),a=(0,o.onSnapshot)(c,a=>{L(a.docs.map(a=>{let b=a.data(),c=Array.isArray(b.memberIds)?b.memberIds:[];return{id:a.id,name:b.name??H("unnamedGroup"),memberCount:c.length||1,totalExpenses:0,yourBalance:0,lastActivity:H("groupCreated"),lastActivityTime:b.createdAt&&"function"==typeof b.createdAt.toDate?b.createdAt.toDate():new Date,isActive:b.isActive??!0}})),J(!1)},a=>{console.error("Failed to fetch groups:",a),L([]),J(!1)})});return()=>{a&&a(),b()}},[]);let[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)("active"),W=a=>{let b=new Date().getTime()-a.getTime(),c=Math.floor(b/6e4),d=Math.floor(b/36e5),e=Math.floor(b/864e5);return c<60?`${c}m ago`:d<24?`${d}h ago`:e<7?`${e}d ago`:a.toLocaleDateString()},X=async()=>{if(!Q.trim())return void z({title:H("invalidInput"),description:H("enterGroupNameError"),variant:"destructive"});let b=Q.trim();J(!0);try{let{groupId:c}=await p(b);z({title:H("groupCreated"),description:`${b} ${H("groupCreatedDesc")}`}),N(!1),R(""),a.push(`/groups/${c}`)}catch(a){console.error("Failed to create group:",a),z({title:H("genericErrorTitle"),description:H("genericErrorDesc"),variant:"destructive"})}finally{J(!1)}},Y=async()=>{let b=n.auth.currentUser,c=S.trim().toUpperCase();if(!b)return void z({title:H("loginRequired"),description:H("loginRequiredDesc"),variant:"destructive"});if(!c)return void z({title:H("enterCodeTitle"),description:H("enterCodeDesc"),variant:"destructive"});J(!0);try{let d=(0,o.doc)(n.db,"groupInvites",c),e=await (0,o.getDoc)(d);if(!e.exists())return void z({title:H("invalidCode"),description:H("inviteNotFound"),variant:"destructive"});let f=e.data();if(f.disabled)return void z({title:H("inviteDisabled"),description:H("inviteDisabledDesc"),variant:"destructive"});let g=f.groupId;if(!g)return void z({title:H("invalidInput"),description:H("inviteMissingInfo"),variant:"destructive"});let h=(0,o.doc)(n.db,"groups",g);await (0,o.updateDoc)(h,{memberIds:(0,o.arrayUnion)(b.uid)});try{await (0,o.addDoc)((0,o.collection)(n.db,"groups",g,"feed"),{type:"join",title:"memberJoined",createdAt:(0,o.serverTimestamp)(),createdBy:b.uid,createdByName:b.displayName||b.email||"Someone"})}catch(a){console.warn("Failed to write join activity:",a)}z({title:H("joinedTitle"),description:H("joinedDesc")}),P(!1),T(""),a.push(`/groups/${g}`)}catch(a){console.error("Failed to join group:",a),z({title:H("genericErrorTitle"),description:H("genericErrorDesc"),variant:"destructive"})}finally{J(!1)}},Z=async(a,b)=>{try{await (0,o.updateDoc)((0,o.doc)(n.db,"groups",a.id),{isActive:b}),z({title:b?H("unarchiveSuccess"):H("archiveSuccess"),description:a.name})}catch(a){console.error("Failed to update group status:",a),z({title:H("genericErrorTitle"),description:H("failedToUpdate"),variant:"destructive"})}},$=K.filter(a=>"active"===U?a.isActive:"archived"!==U||!a.isActive);return I?(0,b.jsxs)("div",{className:"min-h-screen bg-background pb-20",children:[(0,b.jsx)("div",{className:"border-b bg-card",children:(0,b.jsxs)("div",{className:"mx-auto max-w-4xl p-3 sm:p-6",children:[(0,b.jsx)(h.Skeleton,{className:"h-8 w-32 mb-4"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Skeleton,{className:"h-10 w-32"}),(0,b.jsx)(h.Skeleton,{className:"h-10 w-32"})]})]})}),(0,b.jsxs)("div",{className:"mx-auto max-w-4xl p-3 sm:p-6 space-y-3 sm:space-y-4",children:[(0,b.jsx)(h.Skeleton,{className:"h-32"}),(0,b.jsx)(h.Skeleton,{className:"h-32"}),(0,b.jsx)(h.Skeleton,{className:"h-32"})]})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-background pb-20",children:[(0,b.jsx)("div",{className:"border-b bg-card",children:(0,b.jsxs)("div",{className:"mx-auto max-w-4xl p-3 sm:p-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl sm:text-2xl font-bold",children:H("myGroups")}),(0,b.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:[K.filter(a=>a.isActive).length," ",H("activeGroups")]})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(i.Dialog,{open:M,onOpenChange:N,children:[(0,b.jsx)(i.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{size:"sm",className:"flex-1 sm:flex-none h-10 sm:h-9",children:[(0,b.jsx)(q.Plus,{className:"mr-1 h-4 w-4"}),H("createNewGroup")]})}),(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsx)(i.DialogHeader,{children:(0,b.jsx)(i.DialogTitle,{children:H("createNewGroup")})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{htmlFor:"group-name",children:H("groupName")}),(0,b.jsx)(j.Input,{id:"group-name",placeholder:H("enterGroupNamePlaceholder"),value:Q,onChange:a=>R(a.target.value),className:"mt-2"})]}),(0,b.jsx)(e.Button,{onClick:X,className:"w-full",children:H("createNewGroup")})]})]})]}),(0,b.jsxs)(i.Dialog,{open:O,onOpenChange:P,children:[(0,b.jsx)(i.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",className:"flex-1 sm:flex-none h-10 sm:h-9 bg-transparent",children:[(0,b.jsx)(v.Link,{className:"mr-1 h-4 w-4"}),H("joinViaCode")]})}),(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsx)(i.DialogHeader,{children:(0,b.jsx)(i.DialogTitle,{children:H("joinGroup")})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{htmlFor:"join-code",children:H("inviteCode")}),(0,b.jsx)(j.Input,{id:"join-code",placeholder:H("enterInviteCodePlaceholder"),value:S,onChange:a=>T(a.target.value),className:"mt-2"})]}),(0,b.jsx)(e.Button,{onClick:Y,className:"w-full",disabled:I||!S.trim(),children:I?H("joining"):H("joinGroup")})]})]})]})]})]})}),(0,b.jsx)("div",{className:"mx-auto max-w-4xl p-3 sm:p-6",children:(0,b.jsxs)(l.Tabs,{value:U,onValueChange:V,className:"w-full",children:[(0,b.jsxs)(l.TabsList,{className:"w-full sm:w-auto mb-3 sm:mb-4",children:[(0,b.jsx)(l.TabsTrigger,{value:"active",className:"flex-1 sm:flex-none",children:H("activeTab")}),(0,b.jsx)(l.TabsTrigger,{value:"archived",className:"flex-1 sm:flex-none",children:H("archivedTab")})]}),(0,b.jsx)(l.TabsContent,{value:"active",className:"space-y-3 sm:space-y-4",children:$.length>0?(0,b.jsx)("div",{className:"grid gap-3 sm:gap-4 sm:grid-cols-2",children:$.map(c=>(0,b.jsx)(f.Card,{className:"p-3 sm:p-4 cursor-pointer hover:bg-accent/50 transition-colors relative group",onClick:()=>a.push(`/groups/${c.id}`),children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold text-base sm:text-lg truncate",children:c.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(r.Users,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,b.jsx)("span",{children:c.memberCount})]}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"•"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(s.DollarSign,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,b.jsx)("span",{children:G(c.totalExpenses)})]})]})]}),0!==c.yourBalance&&(0,b.jsx)(g.Badge,{variant:c.yourBalance>=0?"default":"secondary",className:`shrink-0 ${c.yourBalance>=0?"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-950 dark:text-green-400":"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-950 dark:text-red-400"}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[c.yourBalance>=0?(0,b.jsx)(t.TrendingUp,{className:"h-3 w-3"}):(0,b.jsx)(u.TrendingDown,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[c.yourBalance>=0?"+":"",G(Math.abs(c.yourBalance))]})]})})]}),(0,b.jsx)("div",{className:"absolute top-2 right-2 z-10 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsxs)(F.DropdownMenu,{children:[(0,b.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-background/80",onClick:a=>a.stopPropagation(),onPointerDown:a=>a.stopPropagation(),children:(0,b.jsx)(B.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsx)(F.DropdownMenuContent,{align:"end",children:(0,b.jsxs)(F.DropdownMenuItem,{onSelect:a=>{Z(c,!1)},onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(C,{className:"mr-2 h-4 w-4"}),H("archiveGroup")]})})]})}),(0,b.jsx)("div",{className:"border-t pt-2 sm:pt-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(A,{className:"h-3 w-3 sm:h-4 sm:w-4 shrink-0"}),(0,b.jsx)("p",{className:"truncate flex-1",children:c.lastActivity}),(0,b.jsx)("span",{className:"shrink-0",children:W(c.lastActivityTime)})]})})]})},c.id))}):(0,b.jsx)(f.Card,{className:"p-8 sm:p-12 text-center",children:(0,b.jsxs)("div",{className:"mx-auto max-w-md space-y-4 sm:space-y-6",children:[(0,b.jsx)("div",{className:"mx-auto w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-muted flex items-center justify-center",children:(0,b.jsx)(r.Users,{className:"h-8 w-8 sm:h-10 sm:w-10 text-muted-foreground"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-2",children:H("noActiveGroups")}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:H("createGroupDesc")})]}),(0,b.jsxs)(e.Button,{onClick:()=>N(!0),className:"h-11 sm:h-10",children:[(0,b.jsx)(q.Plus,{className:"mr-2 h-4 w-4"}),H("createFirstGroup")]})]})})}),(0,b.jsx)(l.TabsContent,{value:"archived",className:"space-y-3 sm:space-y-4",children:$.length>0?(0,b.jsx)("div",{className:"grid gap-3 sm:gap-4 sm:grid-cols-2",children:$.map(c=>(0,b.jsx)(f.Card,{className:"p-3 sm:p-4 cursor-pointer hover:bg-accent/50 transition-colors opacity-75 relative group",onClick:()=>a.push(`/groups/${c.id}`),children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold text-base sm:text-lg truncate",children:c.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(r.Users,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,b.jsx)("span",{children:c.memberCount})]}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"•"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(s.DollarSign,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,b.jsx)("span",{children:G(c.totalExpenses)})]})]})]})}),(0,b.jsx)("div",{className:"absolute top-2 right-2 z-10 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsxs)(F.DropdownMenu,{children:[(0,b.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-background/80",onClick:a=>a.stopPropagation(),onPointerDown:a=>a.stopPropagation(),children:(0,b.jsx)(B.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsx)(F.DropdownMenuContent,{align:"end",children:(0,b.jsxs)(F.DropdownMenuItem,{onSelect:a=>{Z(c,!0)},onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(D,{className:"mr-2 h-4 w-4"}),H("unarchiveGroup")]})})]})}),(0,b.jsx)("div",{className:"border-t pt-2 sm:pt-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)(A,{className:"h-3 w-3 sm:h-4 sm:w-4 shrink-0"}),(0,b.jsx)("p",{className:"truncate flex-1",children:c.lastActivity}),(0,b.jsx)("span",{className:"shrink-0",children:W(c.lastActivityTime)})]})})]})},c.id))}):(0,b.jsx)(f.Card,{className:"p-8 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:H("noArchivedGroups")})})})]})}),(0,b.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-card border-t border-border z-50",children:(0,b.jsx)("div",{className:"mx-auto max-w-4xl px-6 py-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-around",children:[(0,b.jsx)("button",{onClick:()=>a.push("/groups"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors","aria-label":H("navGroups"),children:(0,b.jsx)(x.Wallet,{className:"h-6 w-6 text-green-600"})}),(0,b.jsx)("button",{onClick:()=>a.push("/"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors hover:bg-accent","aria-label":H("navHome"),children:(0,b.jsx)(w.Home,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)("button",{onClick:()=>a.push("/profile"),className:"flex flex-col items-center gap-1 p-2 rounded-lg transition-colors hover:bg-accent","aria-label":H("navProfile"),children:(0,b.jsx)(y.User,{className:"h-6 w-6 text-muted-foreground"})})]})})})]})}a.s(["default",()=>G],44162)}];

//# sourceMappingURL=app_groups_page_tsx_97939964._.js.map